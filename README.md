# Автори

- **Гуня Василь**: [vasyl.hunia.kn.2021@lpnu.ua](mailto:vasyl.hunia.kn.2021@lpnu.ua)  
- **Ткач Софія**: [sofiia.tkach.kn.2021@lpnu.ua](mailto:sofiia.tkach.kn.2021@lpnu.ua)  

---

## Задача, яку ми розв'язували:

Створення системи, яка відповідає на питання користувача, використовуючи документи BBC News як джерело знань.  
Користувач вводить запит, система шукає відповідні документи в базі даних і генерує відповідь на основі знайденої інформації.

---

## Короткий опис компонентів:

### **Data source**
Ми використали набір даних [RealTimeData/bbc_news_alltime](https://huggingface.co/datasets/RealTimeData/bbc_news_alltime), який містить новинні статті BBC News, створювані щомісяця з 2017 року. Для пришвидшення пошуку працюємо лише з новинами за останній місяць.

### **Chunking**
Функція `chunker.split_documents`:
- Розбиває документи на чанки розміром до 512 токенів.  
- Використовує токенізатор Hugging Face та спеціальні розділювачі.  
- Видаляє дублікати та повертає список унікальних чанків.

### **LLM**
Модель: [groq/llama3-8b-8192](https://huggingface.co/models/groq/llama3-8b-8192)  
Модель генерує відповіді на основі контексту або запитання, використовуючи бібліотеку `litellm`.

### **Retriever**
Система здійснює пошук за трьома стратегіями:  
1. **Ключові слова (BM25)**: Аналізує ключові слова запиту та документів.  
2. **Семантичний пошук**: Використовує FAISS та модель [thenlper/gte-small](https://huggingface.co/thenlper/gte-small) для перетворення тексту в вектори.  
3. **Комбінований пошук**: Поєднує результати BM25 та семантичного пошуку за допомогою `EnsembleRetriever`.

### **Reranker**
Для покращення релевантності результатів використовується крос-енкодер із бібліотеки [Rerankers](https://github.com/AnswerDotAI/rerankers).  
Також тестували модель ColBERT для більш ефективного ранжування, але залишили крос-енкодер через його високу точність.

### **Citations**
Модель додає посилання на джерела у відповіді, наприклад:  
*"The relevant information can be found in [Chunk 1]."*  
Наприкінці надається список використаних джерел.

### **Векторні бази даних**
Для зберігання та пошуку релевантних фрагментів використовуємо FAISS.  
Ембеддинги створюються за допомогою моделі Hugging Face, а пошук виконується на основі косинусної схожості між векторами.

### **UI**
Інтерфейс створено за допомогою [Gradio](https://www.gradio.app/):  
- Поле для введення запиту.  
- Прапорці для вибору типу пошуку (BM25, семантичний).  
- Повзунок для регулювання температури відповіді.  
- Кнопка "Search".  
- Відповідь із відповідними документами.  

---

## Інструкції з запуску:
1. Ввести запит у поле.  
2. Вибрати налаштування пошуку (BM25/семантичний пошук).  
3. Встановити температуру відповіді (креативність).  
4. Натиснути "Search".  
5. Отримати результат.

---

## Приклади запитань:
- *"What position does Josko Gvardiol play, and how much did Manchester City pay for him?"*  
- *"Who are the presidents of the United States?"*  
- *"Which player won the Ballon d'Or in 2024?"*  
- *"What notable achievements did Jack Draper accomplish during his breakout season on the ATP Tour in 2025?"*  

---

## Демонстрація

- Посилання на GitHub з кодом: [nlp-llm-project](https://github.com/sonyaaat/nlp-llm-project)  
- [Демонстрація роботи проекту](https://drive.google.com/file/d/1IUm91Sspssq_5yhhYcfQwV-4UP6UOVtn/view?usp=sharing)

**Щоб протестувати сервіс:**  
Напишіть нам у Telegram:  
- [@sonyaaat](https://t.me/sonyaaat)  
- [@blueberry808](https://t.me/blueberry808)  

На жаль, сервіс поки не задеплоєно на Hugging Face, але ми можемо запустити його для вас.
